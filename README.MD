# Приложение для обмена данными с ТФОМС
Данное приложение предназначено для отправки в ТФОМС протоколов/счетов в XML формате, получения ответов, редактирования отправляемых файлов, формирования печатных форм счетов в формате XLSX и отчетов.

Представляет собой веб-приложение, запускаемое в браузере, имеет собствнную базу данных в которой хранит данные транзакций. Обмен с сервисом ТФОМС происходит в фоновом режиме и не требует вмешательства оператора.

На данный момент автоматически формат отправляемых файлов приводится из формата 2021 года в формат 2023 года (на момент 09.01.2023 г.)

## Запуск приложения

Для запуска необходим установленный Docker. Приложение упаковано в Docker контейнер, вместе с ним запускается контейнер с СУБД MySQL. Оба контейнера создают тома для хранения собственных данных в файловой системе хоста Docker.

**Хост, на котором будет запущено приложение должен иметь доступ к сервисам ТФОМС**

Перед запуском рекомендуется заменить настройки:

**app/config.py**:
- LOCAL_DATABASE_URI - изменить пароль пользователя root контейнера с MySQL (указать его же в файле **docker-compose.yml** в MYSQL_ROOT_PASSWORD)
- SECRET_KEY - сгенерировать любую alphanumeric последовательность, тип **строка**
- TFOMS_LOGIN - логин пользователя ТФОМС
- TFOMS_PASSWORD - пароль пользователя ТФОМС
- TFOMS_UNID - ID организации в ТФОМС
- DEFAULT_ADMIN_PASSWORD - пароль Администратора приложения

По желанию можно изменить порт, на котором будет доступен веб-интерфейс, параметр APP_PORT (должен совпадать с портом, пробрасываемым сервисом **app** из файла **docker-compose.yml**), по умолчанию 80.

После указания настроек нужно запустить контейнеры (выполнять из каталога приложения, на одном уровне с файлом **docker-compose.yml**):

```sh
docker-compose.exe up -d
```

Первый запуск может быть длительным - в зависимости от скорости доступа в Интернет и быстродействия хоста с Docker.

## Вход в приложение

После запуска контейнеров по умолчанию веб-интерфейс доступен по адресу <http://localhost>. Если Вы меняли порт, то укажите его.
Имя пользователя и пароль по умолчанию: 

**admin admin**

При необходимости можно использовать **nginx** в качестве обратного прокси и использовать **SSL** для шифрованного доступа (изначально предполагалось сугубо внутреннее использование приложения, поэтому шифрование не предусмотрено), можно использовать настройки DNS для задания доменного имени, по которому будет доступен веб-интерфейс приложения.

Также можно создавать пользователей, которые будут работать с приложением, каждый отправляемый файл связан с пользователем, отправившим его.